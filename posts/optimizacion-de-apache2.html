<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Optimización de apache2 | Mi blog</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href=".././rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../en/rss.xml">
<link rel="canonical" href="http://rngkll.github.io/posts/optimizacion-de-apache2.html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]-->
</head>
<body class="home blog">
    <div id="wrap" style="width:850px">
        <div id="container" style="width:560px">
            
            
    <div class="post">
    
    <h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Optimización de apache2</a></h1>

        <div class="meta" style="background-color: rgb(234, 234, 234); ">
        <span class="authordate">
            Publicado: <time class="published" datetime="2013-10-18T11:16:14-06:00">2013-10-18 11:16</time>
               [<a href="optimizacion-de-apache2.md" id="sourcelink">Código fuente</a>]
        </span>
        <br><span class="tags">Etiquetas: 
                    <a class="tag" href=".././etiquetas/apache.html"><span>apache</span></a>
                    <a class="tag" href=".././etiquetas/keepalive.html"><span>keepalive</span></a>
                    <a class="tag" href=".././etiquetas/optimizacion.html"><span>optimizacion</span></a>
                    <a class="tag" href=".././etiquetas/web.html"><span>web</span></a>
                </span>
                <br><span class="authordate">
            

        </span>
        </div>
    <div>
<p>Primero hay que revisar cuales módulos están cargados, esto se puede hacer con</p>
<pre class="code literal-block">apachectl -M
</pre>


<p>Lo ideal es tener solo los módulos necesarios para que el sitio funcione, la cantidad de módulos influye en e tamaño de cada proceso de apache que se encuentra corriendo.</p>
<pre class="code literal-block">HostnameLookups off
</pre>


<p>Cuando un cliente el accede el servidor web, se crea una bitácora en access.log, si esta directiva esta en On se busca el nombre en el servidor de nombres, aun con un cache de dns esto es muy lento.</p>
<p>Cuando se establece una conexión esta se deja escuchando por un tiempo por si se le hace una nueva petición, en el caso de tener muchos visitantes y dejar la conexiones abiertas por mucho tiempo, se crea un problema, por eso se puede bajar el tiempo para poder servir nuevas peticiones. (Esta altamente ligado al MaxClients).</p>
<pre class="code literal-block">KeepAlive On
KeepAliveTimeout 2
</pre>


<p>Para el momento de calcular MaxClients.</p>
<p>Una buena referencia es MaxClients = (total de memoria)/(promedio de memoria utilizada por cada proceso de apache)</p>
<p>Una buena manera de ver el tamaño de un proceso de apache es con el comando <code>ps -ylC apache2 --sort:rss</code></p>
<p>Con esto se puede ver el tamaño del proceso mas grande de ultimo.</p>
<p>Una suma de la columna del rss nos da un valor del total de memoria que esta usando el proceso, esto puede aumentar porque no todos los procesos tiene el mismo tamaño.</p>
<pre class="code literal-block">ps -ylC apache2 --sort:rss | awk '{SUM += $8 } END {print SUM}'
</pre>


<p>Hay que tomar en cuenta también el resto de procesos del servidor.</p>
<p>Utilizando top y acomodando por rss podemos ver los procesos que están utilizando mas memoria, entre estos deberíamos encontrar los procesos de apache y el o los de la base de datos si es que se tiene una.</p>
</div>
    
        <ul class="pager hidden-print">
<li class="previous">
                <a href="openwrt-en-ubiquiti-power-ap-n-+-multiwan.html" rel="prev" title="OpenWRT en Ubiquiti Power AP N + Multiwan">Publicación anterior</a>
            </li>
            <li class="next">
                <a href="instalando-repetierhost-en-ubuntu-1404.html" rel="next" title="Instalando RepetierHost en Ubuntu 1404">Siguiente publicación</a>
            </li>
        </ul>
<script src="https://apis.google.com/js/plusone.js"></script><div class="g-comments" data-href="http://rngkll.github.io/posts/optimizacion-de-apache2.html" data-first_party_property="BLOGGER" data-view_type="FILTERED_POSTMOD">
</div>


    

    </div>

        </div>
        <div id="sidebar">
            <!--Sidebar content-->
            <h1 id="blog-title">
                <a href="http://rngkll.github.io/" title="Mi blog">Mi blog</a>
            </h1>
            
            <small>
                También disponible en: 
                
            <li><a href="http://rngkll.github.io/en/" rel="alternate" hreflang="en">English</a></li>

            </small>
            
            <ul class="unstyled">
<li>
            
                <li>
<a href="../archive.html">Archivo</a>
                </li>
<li>
<a href="../categories/index.html">Etiquetas</a>
                </li>
<li>
<a href="../rss.xml">Canal RSS</a>

            </li>
<li>
<!-- DuckDuckGo custom search -->
<form method="get" id="search" action="//duckduckgo.com/" class="navbar-form pull-left">
<input type="hidden" name="sites" value="http://rngkll.github.io/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
<!-- End of custom search -->
</li>
            
            
            </ul>
</div>
        <div id="footer">
            Contents © 2016 <a href="mailto:alvarosb@gmail.com">Alvaro Segura Del Barco</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a> and <a href="https://github.com" rel="nofollow">Github</a>    
            
        </div>
    </div>
    
            <script src="../assets/js/all-nocdn.js"></script><script src="../assets/js/colorbox-i18n/jquery.colorbox-es.js"></script><script type="text/javascript">jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
</body>
</html>
